<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç³»ç»Ÿæµ‹è¯•å·¥å…·">
    <title>ç³»ç»Ÿæµ‹è¯•å·¥å…· - å©šç¤¼å–œç³–é¢†å–ç³»ç»Ÿ</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ§ª</text></svg>">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/theme.css">
    
    <style>
        body {
            font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 2rem 1rem;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .test-header {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .test-header h1 {
            font-size: 2rem;
            color: #5D4037;
            margin-bottom: 0.5rem;
        }
        
        .test-header p {
            color: #8D6E63;
        }
        
        .section {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .section-title {
            font-size: 1.5rem;
            color: #5D4037;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #E8B4B8;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .test-btn {
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }
        
        .test-btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .test-btn.success {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }
        
        .test-btn.danger {
            background: linear-gradient(135deg, #F44336, #da190b);
        }
        
        .test-btn.warning {
            background: linear-gradient(135deg, #FF9800, #e68900);
        }
        
        .test-btn.info {
            background: linear-gradient(135deg, #2196F3, #0b7dda);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #e8eef5 100%);
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .info-grid {
            display: grid;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem;
            background: #f5f7fa;
            border-radius: 8px;
        }
        
        .info-label {
            font-weight: 600;
            color: #5D4037;
        }
        
        .info-value {
            color: #8D6E63;
            font-family: 'Courier New', monospace;
        }
        
        .console-output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 1rem;
        }
        
        .console-line {
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }
        
        .console-success {
            color: #4CAF50;
        }
        
        .console-error {
            color: #F44336;
        }
        
        .console-warning {
            color: #FF9800;
        }
        
        .console-info {
            color: #2196F3;
        }
        
        .feature-list {
            display: grid;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .feature-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            background: #f5f7fa;
            border-radius: 8px;
        }
        
        .feature-status {
            font-size: 1.2rem;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem 1.5rem;
            background: white;
            color: #667eea;
            text-decoration: none;
            border-radius: 30px;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.3);
        }
        
        .back-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 255, 255, 0.5);
        }
        
        @media (max-width: 768px) {
            .test-container {
                padding: 0;
            }
            
            .section {
                padding: 1.5rem;
            }
            
            .button-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <!-- é¡µé¢å¤´éƒ¨ -->
        <div class="test-header">
            <h1>ğŸ§ª ç³»ç»Ÿæµ‹è¯•å·¥å…·</h1>
            <p>å¼€å‘å’Œæµ‹è¯•è¾…åŠ©å·¥å…·é›†</p>
        </div>

        <!-- æ•°æ®ç”Ÿæˆå·¥å…· -->
        <div class="section">
            <h2 class="section-title">
                <span>ğŸ“Š</span>
                æ•°æ®ç”Ÿæˆå·¥å…·
            </h2>
            <div class="button-grid">
                <button class="test-btn success" onclick="generateAndImport(10)">
                    <span>â•</span>
                    ç”Ÿæˆ 10 æ¡æ•°æ®
                </button>
                <button class="test-btn success" onclick="generateAndImport(50)">
                    <span>â•</span>
                    ç”Ÿæˆ 50 æ¡æ•°æ®
                </button>
                <button class="test-btn success" onclick="generateAndImport(100)">
                    <span>â•</span>
                    ç”Ÿæˆ 100 æ¡æ•°æ®
                </button>
                <button class="test-btn info" onclick="exportSample()">
                    <span>ğŸ“¥</span>
                    å¯¼å‡ºæ ·æœ¬æ•°æ®
                </button>
            </div>
        </div>

        <!-- è¡¨å•å·¥å…· -->
        <div class="section">
            <h2 class="section-title">
                <span>ğŸ“</span>
                è¡¨å•æµ‹è¯•å·¥å…·
            </h2>
            <div class="button-grid">
                <button class="test-btn primary" onclick="autoFill()">
                    <span>âœ¨</span>
                    è‡ªåŠ¨å¡«å……è¡¨å•
                </button>
                <button class="test-btn primary" onclick="openForm()">
                    <span>ğŸ“‹</span>
                    æ‰“å¼€å¡«å†™é¡µé¢
                </button>
            </div>
        </div>

        <!-- å­˜å‚¨ç®¡ç† -->
        <div class="section">
            <h2 class="section-title">
                <span>ğŸ’¾</span>
                å­˜å‚¨ç®¡ç†
            </h2>
            <div class="button-grid">
                <button class="test-btn info" onclick="showStorage()">
                    <span>ğŸ“Š</span>
                    æŸ¥çœ‹å­˜å‚¨ä¿¡æ¯
                </button>
                <button class="test-btn warning" onclick="createBackup()">
                    <span>ğŸ’¾</span>
                    åˆ›å»ºå¤‡ä»½
                </button>
                <button class="test-btn danger" onclick="clearAllStorage()">
                    <span>ğŸ—‘ï¸</span>
                    æ¸…ç©ºå­˜å‚¨
                </button>
            </div>
        </div>

        <!-- ç³»ç»Ÿæµ‹è¯• -->
        <div class="section">
            <h2 class="section-title">
                <span>ğŸ”§</span>
                ç³»ç»Ÿæµ‹è¯•
            </h2>
            <div class="button-grid">
                <button class="test-btn primary" onclick="runTests()">
                    <span>ğŸ§ª</span>
                    è¿è¡Œæ‰€æœ‰æµ‹è¯•
                </button>
                <button class="test-btn info" onclick="checkCompatibility()">
                    <span>ğŸŒ</span>
                    å…¼å®¹æ€§æ£€æµ‹
                </button>
                <button class="test-btn warning" onclick="startMonitor()">
                    <span>âš¡</span>
                    æ€§èƒ½ç›‘æ§
                </button>
                <button class="test-btn success" onclick="openConsole()">
                    <span>ğŸ–¥ï¸</span>
                    æ‰“å¼€æ§åˆ¶å°
                </button>
            </div>
        </div>

        <!-- æ•°æ®ç»Ÿè®¡ -->
        <div class="section">
            <h2 class="section-title">
                <span>ğŸ“Š</span>
                æ•°æ®ç»Ÿè®¡
            </h2>
            <div class="stats-grid" id="statsGrid">
                <div class="stat-card">
                    <div class="stat-label">æ€»è®°å½•æ•°</div>
                    <div class="stat-value" id="statTotal">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ä»Šæ—¥æ–°å¢</div>
                    <div class="stat-value" id="statToday">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">å¾…å‘è´§</div>
                    <div class="stat-value" id="statPending">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">å·²å‘è´§</div>
                    <div class="stat-value" id="statShipped">0</div>
                </div>
            </div>
        </div>

        <!-- ç³»ç»Ÿä¿¡æ¯ -->
        <div class="section">
            <h2 class="section-title">
                <span>â„¹ï¸</span>
                ç³»ç»Ÿä¿¡æ¯
            </h2>
            <div class="info-grid" id="systemInfo">
                <div class="info-item">
                    <span class="info-label">æµè§ˆå™¨</span>
                    <span class="info-value" id="browserInfo">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ç”¨æˆ·ä»£ç†</span>
                    <span class="info-value" id="userAgent">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">å±å¹•åˆ†è¾¨ç‡</span>
                    <span class="info-value" id="screenResolution">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">å­˜å‚¨å®¹é‡</span>
                    <span class="info-value" id="storageSize">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">å­˜å‚¨é¡¹æ•°</span>
                    <span class="info-value" id="storageItems">-</span>
                </div>
            </div>
        </div>

        <!-- æµè§ˆå™¨å…¼å®¹æ€§ -->
        <div class="section">
            <h2 class="section-title">
                <span>ğŸŒ</span>
                æµè§ˆå™¨å…¼å®¹æ€§
            </h2>
            <div class="feature-list" id="featureList">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <!-- æ§åˆ¶å°è¾“å‡º -->
        <div class="section">
            <h2 class="section-title">
                <span>ğŸ–¥ï¸</span>
                æ§åˆ¶å°è¾“å‡º
            </h2>
            <div class="console-output" id="consoleOutput">
                <div class="console-line console-info">ç³»ç»Ÿæµ‹è¯•å·¥å…·å·²å°±ç»ª</div>
                <div class="console-line">æŒ‰ F12 æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯¦ç»†æ—¥å¿—</div>
            </div>
        </div>

        <!-- è¿”å›é“¾æ¥ -->
        <div style="text-align: center; margin-top: 2rem;">
            <a href="index.html" class="back-link">
                <span>â†</span>
                è¿”å›é¦–é¡µ
            </a>
            <a href="admin.html" class="back-link" style="margin-left: 1rem;">
                <span>ğŸ”</span>
                ç®¡ç†åå°
            </a>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/data-manager.js"></script>
    <script src="js/test-utils.js"></script>
    
    <script>
        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initTestPage();
            updateStats();
            updateSystemInfo();
            updateCompatibility();
            
            // å®šæ—¶æ›´æ–°ç»Ÿè®¡
            setInterval(updateStats, 5000);
        });

        /**
         * åˆå§‹åŒ–æµ‹è¯•é¡µé¢
         */
        function initTestPage() {
            log('info', 'æµ‹è¯•é¡µé¢å·²åŠ è½½');
            log('success', `å½“å‰ç³»ç»Ÿç‰ˆæœ¬: ${CONFIG.APP_VERSION}`);
            log('info', `æ–°äºº: ${CONFIG.COUPLE.FULL_NAME}`);
        }

        /**
         * ç”Ÿæˆå¹¶å¯¼å…¥æµ‹è¯•æ•°æ®
         */
        function generateAndImport(count) {
            log('info', `å¼€å§‹ç”Ÿæˆ ${count} æ¡æµ‹è¯•æ•°æ®...`);
            const result = TestUtils.importTestData(count);
            
            if (result.success) {
                log('success', `âœ“ ${result.message}`);
                updateStats();
            } else {
                log('error', `âœ— ${result.message}`);
            }
        }

        /**
         * è‡ªåŠ¨å¡«å……è¡¨å•
         */
        function autoFill() {
            log('warning', 'æ­¤åŠŸèƒ½éœ€è¦åœ¨è¡¨å•é¡µé¢ä½¿ç”¨');
            log('info', 'è¯·æ‰“å¼€ form.html é¡µé¢ï¼Œç„¶ååœ¨æ§åˆ¶å°è¾“å…¥: TestUtils.autoFillForm()');
        }

        /**
         * æ‰“å¼€è¡¨å•é¡µé¢
         */
        function openForm() {
            window.open('form.html', '_blank');
            log('info', 'å·²æ‰“å¼€è¡¨å•é¡µé¢');
        }

        /**
         * æ˜¾ç¤ºå­˜å‚¨ä¿¡æ¯
         */
        function showStorage() {
            const info = TestUtils.showStorageInfo();
            log('info', `å­˜å‚¨é¡¹æ•°: ${info.keys}`);
            log('info', `æ€»å¤§å°: ${(info.totalSize / 1024).toFixed(2)} KB`);
            updateSystemInfo();
        }

        /**
         * åˆ›å»ºå¤‡ä»½
         */
        function createBackup() {
            if (DataManager.createBackup()) {
                log('success', 'âœ“ æ•°æ®å¤‡ä»½æˆåŠŸ');
            } else {
                log('error', 'âœ— æ•°æ®å¤‡ä»½å¤±è´¥');
            }
        }

        /**
         * æ¸…ç©ºå­˜å‚¨
         */
        function clearAllStorage() {
            const result = TestUtils.clearStorage(true);
            if (result.success) {
                log('warning', `âœ“ ${result.message}`);
                updateStats();
                updateSystemInfo();
            } else {
                log('info', result.message);
            }
        }

        /**
         * è¿è¡Œæ‰€æœ‰æµ‹è¯•
         */
        function runTests() {
            log('info', 'å¼€å§‹è¿è¡Œç³»ç»Ÿæµ‹è¯•...');
            TestUtils.runAllTests();
            log('success', 'âœ“ æµ‹è¯•å®Œæˆï¼Œè¯·æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°');
            updateCompatibility();
        }

        /**
         * æ£€æŸ¥å…¼å®¹æ€§
         */
        function checkCompatibility() {
            log('info', 'æ­£åœ¨æ£€æµ‹æµè§ˆå™¨å…¼å®¹æ€§...');
            const result = TestUtils.checkBrowserCompatibility();
            
            if (result.compatible) {
                log('success', 'âœ“ æµè§ˆå™¨å®Œå…¨å…¼å®¹');
            } else {
                log('warning', 'âš  æµè§ˆå™¨ç‰ˆæœ¬è¾ƒä½ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨');
            }
            
            updateCompatibility();
        }

        /**
         * å¯åŠ¨æ€§èƒ½ç›‘æ§
         */
        function startMonitor() {
            TestUtils.startPerformanceMonitor();
            log('success', 'âœ“ æ€§èƒ½ç›‘æ§å·²å¯åŠ¨');
            log('info', 'ç›‘æ§æ•°æ®å°†åœ¨æ§åˆ¶å°å®šæœŸè¾“å‡º');
        }

        /**
         * æ‰“å¼€æ§åˆ¶å°
         */
        function openConsole() {
            log('info', 'è¯·æŒ‰ F12 æˆ–å³é”® â†’ æ£€æŸ¥ æ‰“å¼€å¼€å‘è€…å·¥å…·');
        }

        /**
         * å¯¼å‡ºæ ·æœ¬æ•°æ®
         */
        function exportSample() {
            TestUtils.exportSampleData();
            log('success', 'âœ“ æ ·æœ¬æ•°æ®å·²å¯¼å‡º');
        }

        /**
         * æ›´æ–°ç»Ÿè®¡æ•°æ®
         */
        function updateStats() {
            const stats = DataManager.getStatistics();
            document.getElementById('statTotal').textContent = stats.total;
            document.getElementById('statToday').textContent = stats.today;
            document.getElementById('statPending').textContent = stats.pending;
            document.getElementById('statShipped').textContent = stats.shipped;
        }

        /**
         * æ›´æ–°ç³»ç»Ÿä¿¡æ¯
         */
        function updateSystemInfo() {
            // æµè§ˆå™¨ä¿¡æ¯
            const browser = Utils.getBrowser();
            document.getElementById('browserInfo').textContent = browser;
            
            // ç”¨æˆ·ä»£ç†
            const ua = navigator.userAgent;
            document.getElementById('userAgent').textContent = ua.substring(0, 50) + '...';
            
            // å±å¹•åˆ†è¾¨ç‡
            document.getElementById('screenResolution').textContent = 
                `${window.screen.width} Ã— ${window.screen.height}`;
            
            // å­˜å‚¨ä¿¡æ¯
            const storageSize = DataManager.getStorageSize();
            document.getElementById('storageSize').textContent = 
                `${(storageSize / 1024).toFixed(2)} KB`;
            
            document.getElementById('storageItems').textContent = 
                Object.keys(localStorage).length;
        }

        /**
         * æ›´æ–°å…¼å®¹æ€§ä¿¡æ¯
         */
        function updateCompatibility() {
            const result = TestUtils.checkBrowserCompatibility();
            const featureList = document.getElementById('featureList');
            
            featureList.innerHTML = Object.entries(result.features).map(([feature, supported]) => {
                const status = supported ? 'âœ…' : 'âŒ';
                const statusText = supported ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ';
                return `
                    <div class="feature-item">
                        <span class="feature-status">${status}</span>
                        <span>${feature}</span>
                        <span style="margin-left: auto; color: ${supported ? '#4CAF50' : '#F44336'};">
                            ${statusText}
                        </span>
                    </div>
                `;
            }).join('');
        }

        /**
         * è®°å½•æ—¥å¿—åˆ°é¡µé¢
         */
        function log(type, message) {
            const consoleOutput = document.getElementById('consoleOutput');
            const timestamp = new Date().toLocaleTimeString();
            const line = document.createElement('div');
            line.className = `console-line console-${type}`;
            line.textContent = `[${timestamp}] ${message}`;
            consoleOutput.appendChild(line);
            
            // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
            
            // é™åˆ¶æ—¥å¿—æ•°é‡
            if (consoleOutput.children.length > 100) {
                consoleOutput.removeChild(consoleOutput.firstChild);
            }
        }
    </script>
</body>
</html>
