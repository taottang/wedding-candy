<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç®¡ç†åå° - å©šç¤¼å–œç³–é¢†å–ç³»ç»Ÿ">
    <title>ç®¡ç†åå° - å©šç¤¼å–œç³–é¢†å–ç³»ç»Ÿ</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”</text></svg>">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* =================================================================
           å…¨å±€æ ·å¼
           ================================================================= */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans SC', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        /* =================================================================
           ç™»å½•é¡µé¢æ ·å¼
           ================================================================= */
        .login-page {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .login-box {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 3rem;
            max-width: 450px;
            width: 100%;
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .login-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        
        .login-header h1 {
            color: #5D4037;
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }
        
        .login-header p {
            color: #8D6E63;
            font-size: 0.95rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            color: #5D4037;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }
        
        .form-group input {
            width: 100%;
            padding: 0.9rem 1rem;
            border: 2px solid #E0E0E0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #E8B4B8;
            box-shadow: 0 0 0 3px rgba(232, 180, 184, 0.1);
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
            cursor: pointer;
        }
        
        .checkbox-group label {
            margin: 0;
            font-weight: normal;
            cursor: pointer;
            color: #666;
        }
        
        .error-message {
            display: none;
            background: #FFEBEE;
            color: #C62828;
            padding: 0.8rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            border-left: 4px solid #C62828;
        }
        
        .btn-login {
            width: 100%;
            background: linear-gradient(135deg, #E8B4B8, #D8A4A8);
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(232, 180, 184, 0.4);
        }
        
        .btn-login:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .login-tips {
            margin-top: 2rem;
            text-align: center;
            padding-top: 1.5rem;
            border-top: 1px solid #E0E0E0;
        }
        
        .login-tips p {
            color: #8D6E63;
            font-size: 0.85rem;
            margin: 0.5rem 0;
        }
        
        .back-link {
            display: block;
            text-align: center;
            color: #8D6E63;
            text-decoration: none;
            margin-top: 1rem;
            font-size: 0.9rem;
            transition: color 0.3s;
        }
        
        .back-link:hover {
            color: #E8B4B8;
        }
        
        /* =================================================================
           ç®¡ç†é¡µé¢æ ·å¼
           ================================================================= */
        .admin-page {
            display: none;
            min-height: 100vh;
        }
        
        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .admin-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .header-title {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* ä¸»å†…å®¹åŒº */
        .admin-main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* æ•°æ®æ€»è§ˆé¢æ¿ */
        .stats-section {
            margin-bottom: 2rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 15px;
            flex-shrink: 0;
        }
        
        .stat-icon.total {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .stat-icon.today {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .stat-icon.pending {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        
        .stat-icon.shipped {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
        }
        
        .stat-content {
            flex: 1;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
        }
        
        /* æ•°æ®ç®¡ç†åŒºåŸŸ */
        .data-section {
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 2rem;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
        }
        
        /* å·¥å…·æ  */
        .toolbar {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .toolbar-left {
            display: flex;
            gap: 1rem;
            flex: 1;
            flex-wrap: wrap;
        }
        
        .search-box {
            position: relative;
            flex: 1;
            min-width: 250px;
            max-width: 400px;
        }
        
        .search-box input {
            width: 100%;
            padding: 0.7rem 1rem;
            padding-left: 2.5rem;
            border: 2px solid #E0E0E0;
            border-radius: 25px;
            font-size: 0.9rem;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .search-box::before {
            content: "ğŸ”";
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1rem;
        }
        
        .filter-group {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .filter-select {
            padding: 0.6rem 1rem;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            font-family: inherit;
        }
        
        .filter-select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .toolbar-right {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #4CAF50;
            color: white;
        }
        
        .btn-success:hover {
            background: #45a049;
        }
        
        .btn-warning {
            background: #FF9800;
            color: white;
        }
        
        .btn-warning:hover {
            background: #e68900;
        }
        
        .btn-danger {
            background: #f44336;
            color: white;
        }
        
        .btn-danger:hover {
            background: #da190b;
        }
        
        .btn-info {
            background: #2196F3;
            color: white;
        }
        
        .btn-info:hover {
            background: #0b7dda;
        }
        
        /* æ‰¹é‡æ“ä½œæ  */
        .batch-actions {
            display: none;
            padding: 1rem;
            background: #E3F2FD;
            border-radius: 10px;
            margin-bottom: 1rem;
            align-items: center;
            gap: 1rem;
        }
        
        .batch-actions.active {
            display: flex;
        }
        
        .batch-info {
            flex: 1;
            color: #1976D2;
            font-weight: 500;
        }
        
        .batch-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        /* æ•°æ®è¡¨æ ¼ */
        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            border: 1px solid #E0E0E0;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 0.9rem;
        }
        
        .data-table thead {
            background: #F8F9FA;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .data-table th {
            padding: 1rem 0.75rem;
            text-align: left;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #E0E0E0;
            white-space: nowrap;
        }
        
        .data-table th.sortable {
            cursor: pointer;
            user-select: none;
        }
        
        .data-table th.sortable:hover {
            background: #E9ECEF;
        }
        
        .sort-icon {
            display: inline-block;
            margin-left: 0.3rem;
            opacity: 0.3;
            font-size: 0.8rem;
        }
        
        .data-table th.sorted-asc .sort-icon::after {
            content: "â–²";
            opacity: 1;
        }
        
        .data-table th.sorted-desc .sort-icon::after {
            content: "â–¼";
            opacity: 1;
        }
        
        .data-table td {
            padding: 1rem 0.75rem;
            border-bottom: 1px solid #F0F0F0;
            color: #666;
        }
        
        .data-table tbody tr {
            transition: background-color 0.2s;
        }
        
        .data-table tbody tr:hover {
            background: #FAFAFA;
        }
        
        .data-table tbody tr.selected {
            background: #E3F2FD;
        }
        
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #999;
        }
        
        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }
        
        .empty-state-text {
            font-size: 1.1rem;
        }
        
        /* çŠ¶æ€æ ‡ç­¾ */
        .status-badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
            white-space: nowrap;
        }
        
        .status-badge.pending {
            background: #FFF3E0;
            color: #E65100;
        }
        
        .status-badge.shipped {
            background: #E3F2FD;
            color: #1976D2;
        }
        
        .status-badge.received {
            background: #E8F5E9;
            color: #2E7D32;
        }
        
        /* æ“ä½œæŒ‰é’® */
        .action-buttons {
            display: flex;
            gap: 0.3rem;
        }
        
        .btn-small {
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
            border-radius: 6px;
        }
        
        /* åˆ†é¡µ */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid #E0E0E0;
        }
        
        .pagination-info {
            color: #666;
            font-size: 0.9rem;
        }
        
        .pagination-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .page-btn {
            padding: 0.5rem 0.8rem;
            border: 1px solid #E0E0E0;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            min-width: 36px;
            font-family: inherit;
        }
        
        .page-btn:hover:not(:disabled) {
            border-color: #667eea;
            color: #667eea;
        }
        
        .page-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .page-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .modal-header {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid #E0E0E0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .modal-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.8rem;
            color: #999;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .modal-close:hover {
            background: #F0F0F0;
            color: #666;
        }
        
        .modal-body {
            padding: 2rem;
        }
        
        .detail-grid {
            display: grid;
            gap: 1rem;
        }
        
        .detail-item {
            display: grid;
            grid-template-columns: 120px 1fr;
            gap: 1rem;
            padding: 0.75rem 0;
            border-bottom: 1px solid #F0F0F0;
        }
        
        .detail-item:last-child {
            border-bottom: none;
        }
        
        .detail-label {
            font-weight: 600;
            color: #666;
        }
        
        .detail-value {
            color: #333;
            word-break: break-word;
        }
        
        /* ==================== é«˜çº§å¯¼å‡ºé¢æ¿æ ·å¼ ==================== */
        .export-panel {
            background: #E3F2FD;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid #BBDEFB;
        }
        
        .export-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #BBDEFB;
        }
        
        .export-panel-header h4 {
            margin: 0;
            color: #1976D2;
            font-size: 1.2rem;
        }
        
        .export-section {
            margin-bottom: 1.5rem;
        }
        
        .export-section h5 {
            margin: 0 0 1rem 0;
            color: #333;
            font-size: 1rem;
        }
        
        .export-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 1rem;
        }
        
        .export-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            background: white;
            border: 2px solid #E0E0E0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .export-btn:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }
        
        .export-icon {
            font-size: 2rem;
        }
        
        .export-name {
            font-size: 1rem;
            font-weight: 600;
            color: #333;
        }
        
        .export-desc {
            font-size: 0.8rem;
            color: #999;
        }
        
        .filter-group {
            margin-bottom: 1rem;
        }
        
        .filter-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #555;
            font-weight: 500;
        }
        
        .date-range-inputs {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .filter-input {
            flex: 1;
            padding: 0.6rem 0.8rem;
            border: 1px solid #E0E0E0;
            border-radius: 6px;
            font-size: 0.9rem;
            font-family: inherit;
        }
        
        .region-filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
        }
        
        .export-preview {
            background: white;
            border: 2px dashed #667eea;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
        }
        
        .preview-count {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
            margin: 0 0.5rem;
        }
        
        /* ==================== å¯¼å‡ºè®°å½•æ ·å¼ ==================== */
        .export-history-container {
            min-height: 300px;
        }
        
        .history-item {
            background: #F8F9FA;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid #667eea;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .history-type {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            color: #333;
        }
        
        .history-time {
            font-size: 0.85rem;
            color: #999;
        }
        
        .history-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid #E0E0E0;
        }
        
        .history-detail-label {
            font-size: 0.8rem;
            color: #999;
        }
        
        .history-detail-value {
            font-size: 0.9rem;
            color: #333;
            font-weight: 500;
        }
        
        .export-history-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid #E0E0E0;
        }
        
        .empty-history {
            text-align: center;
            padding: 4rem 2rem;
            color: #999;
        }
        
        .empty-history-icon {
            font-size: 4rem;
            opacity: 0.5;
        }
        
        /* ==================== ç»Ÿè®¡é¢æ¿æ ·å¼ ==================== */
        .statistics-panel {
            margin: 2rem 0;
        }
        
        .panel-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #E0E0E0;
        }
        
        .tab-btn {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .tab-btn:hover {
            color: #667eea;
        }
        
        .tab-btn.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        
        .stats-tab-content {
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        /* å“åº”å¼ */
        @media (max-width: 1024px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .admin-main {
                padding: 1rem;
            }
            
            .header-content {
                padding: 0 1rem;
            }
            
            .header-title {
                font-size: 1.2rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .toolbar {
                flex-direction: column;
            }
            
            .toolbar-left,
            .toolbar-right {
                width: 100%;
            }
            
            .search-box {
                max-width: none;
            }
            
            .data-section {
                padding: 1rem;
            }
            
            .pagination {
                flex-direction: column;
                gap: 1rem;
            }
            
            .detail-item {
                grid-template-columns: 1fr;
                gap: 0.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- ç™»å½•é¡µé¢ -->
    <div class="login-page" id="loginPage">
        <div class="login-box">
            <div class="login-header">
                <div class="login-icon">ğŸ”</div>
                <h1>ç®¡ç†å‘˜ç™»å½•</h1>
                <p>è¯·è¾“å…¥ç®¡ç†å‘˜è´¦å·å¯†ç </p>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">ç”¨æˆ·å</label>
                    <input 
                        type="text" 
                        id="username" 
                        name="username"
                        placeholder="è¯·è¾“å…¥ç”¨æˆ·å"
                        required
                        autocomplete="username"
                    >
                </div>
                
                <div class="form-group">
                    <label for="password">å¯†ç </label>
                    <input 
                        type="password" 
                        id="password" 
                        name="password"
                        placeholder="è¯·è¾“å…¥å¯†ç "
                        required
                        autocomplete="current-password"
                    >
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="remember" name="remember">
                    <label for="remember">è®°ä½ç™»å½•çŠ¶æ€</label>
                </div>
                
                <div class="error-message" id="loginError"></div>
                
                <button type="submit" class="btn-login" id="loginBtn">ç™»å½•</button>
                
                <div class="login-tips">
                    <p>å¿˜è®°å¯†ç ï¼Ÿè¯·è”ç³»æŠ€æœ¯æ”¯æŒ</p>
                    <p style="color: #BCAAA4;">é»˜è®¤ç”¨æˆ·åï¼šadmin</p>
                </div>
                
                <a href="index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
            </form>
        </div>
    </div>

    <!-- ç®¡ç†é¡µé¢ -->
    <div class="admin-page" id="adminPage">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <header class="admin-header">
            <div class="header-content">
                <div class="header-left">
                    <div class="header-title">ğŸ’ å©šç¤¼å–œç³–ç®¡ç†ç³»ç»Ÿ</div>
                </div>
                <div class="header-right">
                    <div class="user-info">
                        <span>ğŸ‘¤</span>
                        <span id="usernameDisplay">admin</span>
                    </div>
                    <button class="btn btn-secondary" onclick="openSettingsModal()">âš™ï¸ ç³»ç»Ÿç®¡ç†</button>
                    <button class="btn btn-secondary" onclick="handleLogout()">ğŸšª é€€å‡º</button>
                </div>
            </div>
        </header>

        <!-- ä¸»å†…å®¹åŒº -->
        <main class="admin-main">
            <!-- æ•°æ®æ€»è§ˆé¢æ¿ -->
            <section class="stats-section">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon total">ğŸ“Š</div>
                        <div class="stat-content">
                            <div class="stat-label">æ€»æäº¤äººæ•°</div>
                            <div class="stat-value" id="statTotal">0</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon today">ğŸ‰</div>
                        <div class="stat-content">
                            <div class="stat-label">ä»Šæ—¥æ–°å¢</div>
                            <div class="stat-value" id="statToday">0</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon pending">â³</div>
                        <div class="stat-content">
                            <div class="stat-label">å¾…å‘è´§æ•°é‡</div>
                            <div class="stat-value" id="statPending">0</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon shipped">âœˆï¸</div>
                        <div class="stat-content">
                            <div class="stat-label">å·²å‘è´§æ•°é‡</div>
                            <div class="stat-value" id="statShipped">0</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- è¯¦ç»†ç»Ÿè®¡é¢æ¿ -->
            <section class="statistics-panel" style="margin: 2rem 0;">
                <div class="panel-tabs" style="display: flex; gap: 1rem; margin-bottom: 1.5rem; border-bottom: 2px solid #E0E0E0;">
                    <button class="tab-btn active" onclick="switchStatsTab('trend')" data-tab="trend" style="
                        padding: 0.75rem 1.5rem;
                        background: none;
                        border: none;
                        border-bottom: 3px solid transparent;
                        cursor: pointer;
                        font-size: 1rem;
                        font-weight: 600;
                        color: #666;
                        transition: all 0.3s;
                        font-family: inherit;
                    ">
                        ğŸ“ˆ æäº¤è¶‹åŠ¿
                    </button>
                    <button class="tab-btn" onclick="switchStatsTab('region')" data-tab="region" style="
                        padding: 0.75rem 1.5rem;
                        background: none;
                        border: none;
                        border-bottom: 3px solid transparent;
                        cursor: pointer;
                        font-size: 1rem;
                        font-weight: 600;
                        color: #666;
                        transition: all 0.3s;
                        font-family: inherit;
                    ">
                        ğŸ—ºï¸ åœ°åŒºåˆ†å¸ƒ
                    </button>
                    <button class="tab-btn" onclick="switchStatsTab('relation')" data-tab="relation" style="
                        padding: 0.75rem 1.5rem;
                        background: none;
                        border: none;
                        border-bottom: 3px solid transparent;
                        cursor: pointer;
                        font-size: 1rem;
                        font-weight: 600;
                        color: #666;
                        transition: all 0.3s;
                        font-family: inherit;
                    ">
                        ğŸ‘¥ å…³ç³»åˆ†å¸ƒ
                    </button>
                </div>
                
                <!-- æäº¤è¶‹åŠ¿ -->
                <div class="stats-tab-content" id="trendTab" style="display: block;">
                    <div class="stats-card" style="
                        background: white;
                        border-radius: 15px;
                        padding: 2rem;
                        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
                    ">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                            <h3 style="margin: 0; font-size: 1.3rem; color: #333;">
                                ğŸ“ˆ æœ€è¿‘7å¤©æäº¤è¶‹åŠ¿
                            </h3>
                            <button class="btn btn-secondary btn-small" onclick="refreshStatistics()">
                                ğŸ”„ åˆ·æ–°
                            </button>
                        </div>
                        <div id="trendChartContainer" style="min-height: 250px;">
                            <!-- è¶‹åŠ¿å›¾å°†åŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <!-- åœ°åŒºåˆ†å¸ƒ -->
                <div class="stats-tab-content" id="regionTab" style="display: none;">
                    <div class="stats-card" style="
                        background: white;
                        border-radius: 15px;
                        padding: 2rem;
                        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
                    ">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                            <h3 style="margin: 0; font-size: 1.3rem; color: #333;">
                                ğŸ—ºï¸ åœ°åŒºåˆ†å¸ƒç»Ÿè®¡ï¼ˆTop 10ï¼‰
                            </h3>
                            <button class="btn btn-secondary btn-small" onclick="exportRegionReport()">
                                ğŸ“¥ å¯¼å‡ºæŠ¥å‘Š
                            </button>
                        </div>
                        <div id="regionChartContainer" style="min-height: 400px;">
                            <!-- åœ°åŒºåˆ†å¸ƒå›¾å°†åŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <!-- å…³ç³»åˆ†å¸ƒ -->
                <div class="stats-tab-content" id="relationTab" style="display: none;">
                    <div class="stats-card" style="
                        background: white;
                        border-radius: 15px;
                        padding: 2rem;
                        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
                    ">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                            <h3 style="margin: 0; font-size: 1.3rem; color: #333;">
                                ğŸ‘¥ å…³ç³»åˆ†å¸ƒç»Ÿè®¡
                            </h3>
                        </div>
                        <div id="relationChartContainer" style="min-height: 250px;">
                            <!-- å…³ç³»åˆ†å¸ƒå›¾å°†åŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- æ•°æ®ç®¡ç†åŒºåŸŸ -->
            <section class="data-section">
                <div class="section-header">
                    <h2 class="section-title">ğŸ“‹ é¢†å–è®°å½•</h2>
                </div>

                <!-- å·¥å…·æ  -->
                <div class="toolbar">
                    <div class="toolbar-left">
                        <div class="search-box">
                            <input 
                                type="text" 
                                id="searchInput" 
                                placeholder="æœç´¢å§“åã€ç”µè¯ã€å¾®ä¿¡..."
                            >
                        </div>
                        
                        <div class="filter-group">
                            <select class="filter-select" id="filterStatus">
                                <option value="">å…¨éƒ¨çŠ¶æ€</option>
                                <option value="pending">å¾…å‘è´§</option>
                                <option value="shipped">å·²å‘è´§</option>
                                <option value="received">å·²ç­¾æ”¶</option>
                            </select>
                            
                            <select class="filter-select" id="filterProvince">
                                <option value="">å…¨éƒ¨åœ°åŒº</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="toolbar-right">
                        <button class="btn btn-success" onclick="showExportDialog()">
                            ğŸ“¥ é«˜çº§å¯¼å‡º
                        </button>
                        <button class="btn btn-secondary" onclick="showExportHistory()">
                            ğŸ“Š å¯¼å‡ºè®°å½•
                        </button>
                    </div>
                </div>
                
                <!-- é«˜çº§å¯¼å‡ºå¯¹è¯æ¡† -->
                <div class="export-panel" id="exportPanel" style="display: none;">
                    <div class="export-panel-header">
                        <h4>ğŸ¯ é«˜çº§å¯¼å‡ºé€‰é¡¹</h4>
                        <button class="modal-close" onclick="hideExportDialog()">&times;</button>
                    </div>
                    
                    <div class="export-panel-body">
                        <!-- å¯¼å‡ºæ–¹å¼ -->
                        <div class="export-section">
                            <h5>ğŸ“¦ é€‰æ‹©å¯¼å‡ºæ–¹å¼</h5>
                            <div class="export-buttons">
                                <button class="export-btn" onclick="quickExport('excel')">
                                    <span class="export-icon">ğŸ“Š</span>
                                    <span class="export-name">Excel</span>
                                    <span class="export-desc">å®Œæ•´åŠŸèƒ½</span>
                                </button>
                                <button class="export-btn" onclick="quickExport('csv')">
                                    <span class="export-icon">ğŸ“„</span>
                                    <span class="export-name">CSV</span>
                                    <span class="export-desc">çº¯æ–‡æœ¬</span>
                                </button>
                                <button class="export-btn" onclick="quickExport('print')">
                                    <span class="export-icon">ğŸ–¨ï¸</span>
                                    <span class="export-name">æ‰“å°</span>
                                    <span class="export-desc">ç›´æ¥æ‰“å°</span>
                                </button>
                                <button class="export-btn" onclick="quickExport('clipboard')">
                                    <span class="export-icon">ğŸ“‹</span>
                                    <span class="export-name">å‰ªè´´æ¿</span>
                                    <span class="export-desc">å¿«é€Ÿå¤åˆ¶</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- æ•°æ®ç­›é€‰ -->
                        <div class="export-section">
                            <h5>ğŸ” æ•°æ®ç­›é€‰ï¼ˆå¯é€‰ï¼‰</h5>
                            
                            <div class="filter-group">
                                <label>æ—¶é—´èŒƒå›´ï¼š</label>
                                <div class="date-range-inputs">
                                    <input type="date" id="exportDateStart" class="filter-input">
                                    <span>è‡³</span>
                                    <input type="date" id="exportDateEnd" class="filter-input">
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <label>åœ°åŒºç­›é€‰ï¼š</label>
                                <div class="region-filters">
                                    <select id="exportProvince" class="filter-select" onchange="updateExportCities()">
                                        <option value="">å…¨éƒ¨çœä»½</option>
                                    </select>
                                    <select id="exportCity" class="filter-select" onchange="updateExportDistricts()">
                                        <option value="">å…¨éƒ¨åŸå¸‚</option>
                                    </select>
                                    <select id="exportDistrict" class="filter-select">
                                        <option value="">å…¨éƒ¨åŒºå¿</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <label>çŠ¶æ€ç­›é€‰ï¼š</label>
                                <select id="exportStatus" class="filter-select">
                                    <option value="all">å…¨éƒ¨çŠ¶æ€</option>
                                    <option value="pending">å¾…å‘è´§</option>
                                    <option value="shipped">å·²å‘è´§</option>
                                    <option value="received">å·²ç­¾æ”¶</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label>å…³ç³»ç­›é€‰ï¼š</label>
                                <select id="exportRelation" class="filter-select">
                                    <option value="all">å…¨éƒ¨å…³ç³»</option>
                                    <option value="family">å®¶äºº</option>
                                    <option value="relative">äº²æˆš</option>
                                    <option value="friend">æœ‹å‹</option>
                                    <option value="colleague">åŒäº‹</option>
                                    <option value="classmate">åŒå­¦</option>
                                    <option value="other">å…¶ä»–</option>
                                </select>
                            </div>
                            
                            <button class="btn btn-secondary btn-small" onclick="resetExportFilters()">
                                ğŸ”„ é‡ç½®ç­›é€‰
                            </button>
                        </div>
                        
                        <!-- é¢„è§ˆç»Ÿè®¡ -->
                        <div class="export-section">
                            <div class="export-preview">
                                <span class="preview-label">å°†è¦å¯¼å‡ºï¼š</span>
                                <span class="preview-count" id="exportPreviewCount">0</span>
                                <span class="preview-label">æ¡è®°å½•</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ‰¹é‡æ“ä½œæ  -->
                <div class="batch-actions" id="batchActions">
                    <div class="batch-info">
                        å·²é€‰æ‹© <strong id="selectedCount">0</strong> æ¡è®°å½•
                    </div>
                    <div class="batch-buttons">
                        <button class="btn btn-success btn-small" onclick="batchExport()">
                            å¯¼å‡ºé€‰ä¸­
                        </button>
                        <button class="btn btn-warning btn-small" onclick="batchUpdateStatus()">
                            æ‰¹é‡æ ‡è®°å·²å‘è´§
                        </button>
                        <button class="btn btn-danger btn-small" onclick="batchDelete()">
                            æ‰¹é‡åˆ é™¤
                        </button>
                        <button class="btn btn-secondary btn-small" onclick="clearSelection()">
                            å–æ¶ˆé€‰æ‹©
                        </button>
                    </div>
                </div>

                <!-- æ•°æ®è¡¨æ ¼ -->
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th width="50">
                                    <input type="checkbox" id="selectAll" onchange="handleSelectAll()">
                                </th>
                                <th width="60">åºå·</th>
                                <th class="sortable" data-sort="name" onclick="handleSort('name')">
                                    å§“å<span class="sort-icon"></span>
                                </th>
                                <th class="sortable" data-sort="phone" onclick="handleSort('phone')">
                                    æ‰‹æœºå·<span class="sort-icon"></span>
                                </th>
                                <th>å¾®ä¿¡å·</th>
                                <th>åœ°åŒº</th>
                                <th>è¯¦ç»†åœ°å€</th>
                                <th class="sortable" data-sort="submit_time" onclick="handleSort('submit_time')">
                                    æäº¤æ—¶é—´<span class="sort-icon"></span>
                                </th>
                                <th>çŠ¶æ€</th>
                                <th width="200">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="dataTableBody">
                            <!-- æ•°æ®è¡ŒåŠ¨æ€ç”Ÿæˆ -->
                        </tbody>
                    </table>
                </div>

                <!-- åˆ†é¡µ -->
                <div class="pagination">
                    <div class="pagination-info">
                        æ˜¾ç¤ºç¬¬ <strong id="rangeStart">0</strong> è‡³ <strong id="rangeEnd">0</strong> æ¡ï¼Œ
                        å…± <strong id="totalRecords">0</strong> æ¡è®°å½•
                    </div>
                    <div class="pagination-controls">
                        <button class="page-btn" id="btnFirst" onclick="goToPage(1)">é¦–é¡µ</button>
                        <button class="page-btn" id="btnPrev" onclick="prevPage()">ä¸Šä¸€é¡µ</button>
                        <div id="pageNumbers"></div>
                        <button class="page-btn" id="btnNext" onclick="nextPage()">ä¸‹ä¸€é¡µ</button>
                        <button class="page-btn" id="btnLast" onclick="goToLastPage()">æœ«é¡µ</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div class="modal" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ“„ è¯¦ç»†ä¿¡æ¯</h3>
                <button class="modal-close" onclick="closeModal('detailModal')">&times;</button>
            </div>
            <div class="modal-body" id="detailModalBody">
                <!-- è¯¦æƒ…å†…å®¹åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- ç³»ç»Ÿç®¡ç†æ¨¡æ€æ¡† -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">âš™ï¸ ç³»ç»Ÿç®¡ç†</h3>
                <button class="modal-close" onclick="closeModal('settingsModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-grid">
                    <div style="padding: 1rem 0;">
                        <h4 style="margin-bottom: 1rem;">ä¿®æ”¹å¯†ç </h4>
                        <div class="form-group">
                            <label>æ—§å¯†ç </label>
                            <input type="password" id="oldPassword" class="filter-select" style="width: 100%;" placeholder="è¯·è¾“å…¥æ—§å¯†ç ">
                        </div>
                        <div class="form-group">
                            <label>æ–°å¯†ç </label>
                            <input type="password" id="newPassword" class="filter-select" style="width: 100%;" placeholder="è¯·è¾“å…¥æ–°å¯†ç ">
                        </div>
                        <button class="btn btn-primary" onclick="changePassword()" style="width: 100%; margin-top: 0.5rem;">ç¡®è®¤ä¿®æ”¹</button>
                    </div>
                    
                    <div style="padding: 1rem 0; border-top: 1px solid #E0E0E0;">
                        <h4 style="margin-bottom: 1rem;">æ•°æ®ç®¡ç†</h4>
                        
                        <!-- å¤‡ä»½ä¿¡æ¯ -->
                        <div id="backupInfo" style="
                            background: #F8F9FA;
                            padding: 12px;
                            border-radius: 8px;
                            margin-bottom: 12px;
                            font-size: 13px;
                            color: #666;
                        ">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>æœ€åå¤‡ä»½ï¼š</span>
                                <span id="lastBackupTime">-</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>å½“å‰æ•°æ®é‡ï¼š</span>
                                <span id="currentRecordCount">-</span>
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            <button class="btn btn-info" onclick="handleBackupData()" title="å¯¼å‡ºå®Œæ•´JSONå¤‡ä»½æ–‡ä»¶">
                                ğŸ“¦ å¤‡ä»½æ•°æ®
                            </button>
                            <button class="btn btn-warning" onclick="handleRestoreData()" title="ä»JSONæ–‡ä»¶æ¢å¤æ•°æ®">
                                â™»ï¸ æ¢å¤æ•°æ®
                            </button>
                            <button class="btn btn-danger" onclick="handleClearAllData()" title="æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼ˆéœ€å¯†ç ç¡®è®¤ï¼‰">
                                ğŸ—‘ï¸ æ¸…ç©ºæ•°æ®
                            </button>
                        </div>
                    </div>
                    
                    <div style="padding: 1rem 0; border-top: 1px solid #E0E0E0;">
                        <h4 style="margin-bottom: 1rem;">ç³»ç»Ÿä¿¡æ¯</h4>
                        <div class="detail-item">
                            <div class="detail-label">ç³»ç»Ÿç‰ˆæœ¬</div>
                            <div class="detail-value">v1.0.0</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">å­˜å‚¨ç©ºé—´</div>
                            <div class="detail-value" id="storageInfo">-</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ä¼šè¯å‰©ä½™æ—¶é—´</div>
                            <div class="detail-value" id="sessionInfo">-</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¯¼å‡ºè®°å½•æ¨¡æ€æ¡† -->
    <div class="modal" id="exportHistoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ“Š å¯¼å‡ºè®°å½•</h3>
                <button class="modal-close" onclick="closeModal('exportHistoryModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-history-container" id="exportHistoryContainer">
                    <!-- å¯¼å‡ºè®°å½•åŠ¨æ€ç”Ÿæˆ -->
                </div>
                <div class="export-history-footer">
                    <button class="btn btn-secondary" onclick="clearExportHistoryConfirm()">
                        ğŸ—‘ï¸ æ¸…ç©ºè®°å½•
                    </button>
                    <span class="history-note">* æœ€å¤šæ˜¾ç¤ºæœ€è¿‘5æ¡å¯¼å‡ºè®°å½•</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/data-manager.js"></script>
    <script src="js/admin-auth.js"></script>
    <script src="js/export-utils.js"></script>
    <script src="js/export-manager.js"></script>
    <script src="js/backup-manager.js"></script>
    <script src="js/statistics-manager.js"></script></script></script>
    
    <script>
        // =================================================================
        // å…¨å±€å˜é‡
        // =================================================================
        let currentPage = 1;
        let pageSize = 20;
        let totalPages = 1;
        let allData = [];
        let filteredData = [];
        let selectedIds = new Set();
        let currentSort = { field: 'submit_time', order: 'desc' };

        // =================================================================
        // é¡µé¢åˆå§‹åŒ–
        // =================================================================
        document.addEventListener('DOMContentLoaded', function() {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (AdminAuth.isAuthenticated()) {
                showAdminPage();
            } else {
                showLoginPage();
            }
        });

        // =================================================================
        // ç™»å½•ç›¸å…³
        // =================================================================
        function showLoginPage() {
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('adminPage').style.display = 'none';
            
            // å¡«å……è®°ä½çš„ç”¨æˆ·å
            const rememberedUsername = AdminAuth.getRememberedUsername();
            if (rememberedUsername) {
                document.getElementById('username').value = rememberedUsername;
                document.getElementById('remember').checked = true;
            }
            
            // ç»‘å®šç™»å½•è¡¨å•
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
        }

        function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const remember = document.getElementById('remember').checked;
            const errorDiv = document.getElementById('loginError');
            const loginBtn = document.getElementById('loginBtn');
            
            // æ¸…é™¤é”™è¯¯æç¤º
            errorDiv.style.display = 'none';
            
            // ç¦ç”¨æŒ‰é’®
            loginBtn.disabled = true;
            loginBtn.textContent = 'ç™»å½•ä¸­...';
            
            // æ‰§è¡Œç™»å½•
            setTimeout(() => {
                const result = AdminAuth.login(username, password, remember);
                
                if (result.success) {
                    showAdminPage();
                } else {
                    errorDiv.style.display = 'block';
                    errorDiv.textContent = result.message;
                    loginBtn.disabled = false;
                    loginBtn.textContent = 'ç™»å½•';
                    document.getElementById('password').value = '';
                }
            }, 500);
        }

        function showAdminPage() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('adminPage').style.display = 'block';
            
            // æ˜¾ç¤ºç”¨æˆ·å
            const session = AdminAuth.getSession();
            if (session) {
                document.getElementById('usernameDisplay').textContent = session.username;
            }
            
            // åŠ è½½æ•°æ®
            loadDashboard();
            loadProvinceFilter();
        }

        function handleLogout() {
            if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                AdminAuth.logout();
                location.reload();
            }
        }

        // =================================================================
        // æ•°æ®åŠ è½½
        // =================================================================
        function loadDashboard() {
            // åŠ è½½ç»Ÿè®¡æ•°æ®
            const stats = DataManager.getStatistics();
            document.getElementById('statTotal').textContent = stats.total;
            document.getElementById('statToday').textContent = stats.today;
            document.getElementById('statPending').textContent = stats.pending;
            document.getElementById('statShipped').textContent = stats.shipped;
            
            // åŠ è½½è¡¨æ ¼æ•°æ®
            allData = DataManager.getAllRecipients();
            applyFilters();
            
            // åŠ è½½è¯¦ç»†ç»Ÿè®¡
            loadDetailedStatistics();
            
            // æ›´æ–°å¤‡ä»½ä¿¡æ¯
            updateBackupInfo();
        }
        
        // =================================================================
        // è¯¦ç»†ç»Ÿè®¡
        // =================================================================
        function loadDetailedStatistics() {
            try {
                // åŠ è½½è¶‹åŠ¿å›¾
                const trends = StatisticsManager.getLast7DaysTrend();
                const trendHtml = StatisticsManager.generateTrendChart(trends);
                document.getElementById('trendChartContainer').innerHTML = trendHtml;
                
                // åŠ è½½åœ°åŒºåˆ†å¸ƒ
                const regions = StatisticsManager.getRegionDistribution();
                const regionHtml = StatisticsManager.generateRegionChart(regions);
                document.getElementById('regionChartContainer').innerHTML = regionHtml;
                
                // åŠ è½½å…³ç³»åˆ†å¸ƒ
                const relations = StatisticsManager.getRelationDistribution();
                const relationHtml = StatisticsManager.generateRelationChart(relations);
                document.getElementById('relationChartContainer').innerHTML = relationHtml;
                
                console.log('Detailed statistics loaded');
            } catch (error) {
                console.error('Load detailed statistics error:', error);
            }
        }
        
        // åˆ‡æ¢ç»Ÿè®¡æ ‡ç­¾
        function switchStatsTab(tabName) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.dataset.tab === tabName) {
                    btn.classList.add('active');
                    btn.style.borderBottomColor = '#667eea';
                    btn.style.color = '#667eea';
                } else {
                    btn.classList.remove('active');
                    btn.style.borderBottomColor = 'transparent';
                    btn.style.color = '#666';
                }
            });
            
            // æ˜¾ç¤ºå¯¹åº”å†…å®¹
            document.querySelectorAll('.stats-tab-content').forEach(content => {
                content.style.display = 'none';
            });
            document.getElementById(tabName + 'Tab').style.display = 'block';
        }
        
        // åˆ·æ–°ç»Ÿè®¡
        function refreshStatistics() {
            Utils.toast('æ­£åœ¨åˆ·æ–°ç»Ÿè®¡æ•°æ®...', 'info');
            setTimeout(() => {
                loadDetailedStatistics();
                Utils.toast('ç»Ÿè®¡æ•°æ®å·²åˆ·æ–°', 'success');
            }, 500);
        }
        
        // å¯¼å‡ºåœ°åŒºæŠ¥å‘Š
        function exportRegionReport() {
            try {
                StatisticsManager.exportReport('json');
            } catch (error) {
                console.error('Export region report error:', error);
                Utils.toast('å¯¼å‡ºå¤±è´¥: ' + error.message, 'error');
            }
        }
        
        // =================================================================
        // å¤‡ä»½ç®¡ç†
        // =================================================================
        function updateBackupInfo() {
            try {
                const info = BackupManager.getBackupInfo();
                document.getElementById('lastBackupTime').textContent = info.lastBackupFormatted;
                document.getElementById('currentRecordCount').textContent = info.currentRecordCount + ' æ¡';
            } catch (error) {
                console.error('Update backup info error:', error);
            }
        }
        
        function handleBackupData() {
            try {
                BackupManager.backupData();
                setTimeout(updateBackupInfo, 500);
            } catch (error) {
                console.error('Handle backup data error:', error);
                Utils.toast('å¤‡ä»½å¤±è´¥: ' + error.message, 'error');
            }
        }
        
        async function handleRestoreData() {
            try {
                const result = await BackupManager.restoreData();
                if (result.success) {
                    // é¡µé¢ä¼šè‡ªåŠ¨åˆ·æ–°
                }
            } catch (error) {
                console.error('Handle restore data error:', error);
                if (!error.message.includes('æœªé€‰æ‹©æ–‡ä»¶')) {
                    Utils.toast('æ¢å¤å¤±è´¥: ' + error.message, 'error');
                }
            }
        }
        
        async function handleClearAllData() {
            try {
                const result = await BackupManager.clearAllData();
                if (result.success) {
                    // é¡µé¢ä¼šè‡ªåŠ¨åˆ·æ–°
                }
            } catch (error) {
                console.error('Handle clear all data error:', error);
                Utils.toast('æ¸…ç©ºå¤±è´¥: ' + error.message, 'error');
            }
        }

        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('filterStatus').value;
            const provinceFilter = document.getElementById('filterProvince').value;
            
            filteredData = allData.filter(item => {
                // æœç´¢è¿‡æ»¤
                const matchSearch = !searchTerm || 
                    item.name.toLowerCase().includes(searchTerm) ||
                    item.phone.includes(searchTerm) ||
                    (item.wechat && item.wechat.toLowerCase().includes(searchTerm));
                
                // çŠ¶æ€è¿‡æ»¤
                const matchStatus = !statusFilter || item.status === statusFilter;
                
                // åœ°åŒºè¿‡æ»¤
                const matchProvince = !provinceFilter || item.address?.province === provinceFilter;
                
                return matchSearch && matchStatus && matchProvince;
            });
            
            // åº”ç”¨æ’åº
            applySorting();
            
            // é‡ç½®é¡µç 
            currentPage = 1;
            totalPages = Math.ceil(filteredData.length / pageSize);
            
            // æ¸²æŸ“è¡¨æ ¼
            renderTable();
            renderPagination();
        }

        function applySorting() {
            filteredData.sort((a, b) => {
                let aVal = a[currentSort.field];
                let bVal = b[currentSort.field];
                
                // ç‰¹æ®Šå¤„ç†æ—¶é—´
                if (currentSort.field === 'submit_time') {
                    aVal = new Date(aVal).getTime();
                    bVal = new Date(bVal).getTime();
                }
                
                if (currentSort.order === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });
        }

        function renderTable() {
            const tbody = document.getElementById('dataTableBody');
            const start = (currentPage - 1) * pageSize;
            const end = start + pageSize;
            const pageData = filteredData.slice(start, end);
            
            if (pageData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="10">
                            <div class="empty-state">
                                <div class="empty-state-icon">ğŸ“­</div>
                                <div class="empty-state-text">æš‚æ— æ•°æ®</div>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = pageData.map((item, index) => `
                <tr class="${selectedIds.has(item.id) ? 'selected' : ''}">
                    <td>
                        <input 
                            type="checkbox" 
                            value="${item.id}"
                            ${selectedIds.has(item.id) ? 'checked' : ''}
                            onchange="handleSelectRow('${item.id}')"
                        >
                    </td>
                    <td>${start + index + 1}</td>
                    <td>${Utils.escapeHtml(item.name)}</td>
                    <td>${item.phone}</td>
                    <td>${Utils.escapeHtml(item.wechat || '-')}</td>
                    <td>${item.address?.province || ''} ${item.address?.city || ''}</td>
                    <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                        ${Utils.escapeHtml(item.address?.detail || '-')}
                    </td>
                    <td>${item.submit_time_formatted || Utils.formatDate(item.submit_time, 'YYYY-MM-DD HH:mm')}</td>
                    <td>
                        <span class="status-badge ${item.status}">
                            ${item.status_text || getStatusText(item.status)}
                        </span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-info btn-small" onclick="viewDetail('${item.id}')">
                                æŸ¥çœ‹
                            </button>
                            <button class="btn btn-warning btn-small" onclick="toggleStatus('${item.id}')">
                                åˆ‡æ¢
                            </button>
                            <button class="btn btn-danger btn-small" onclick="deleteRecord('${item.id}')">
                                åˆ é™¤
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function getStatusText(status) {
            const map = {
                'pending': 'å¾…å‘è´§',
                'shipped': 'å·²å‘è´§',
                'received': 'å·²ç­¾æ”¶'
            };
            return map[status] || status;
        }

        function renderPagination() {
            document.getElementById('rangeStart').textContent = filteredData.length > 0 ? (currentPage - 1) * pageSize + 1 : 0;
            document.getElementById('rangeEnd').textContent = Math.min(currentPage * pageSize, filteredData.length);
            document.getElementById('totalRecords').textContent = filteredData.length;
            
            // åˆ†é¡µæŒ‰é’®
            document.getElementById('btnFirst').disabled = currentPage === 1;
            document.getElementById('btnPrev').disabled = currentPage === 1;
            document.getElementById('btnNext').disabled = currentPage === totalPages || totalPages === 0;
            document.getElementById('btnLast').disabled = currentPage === totalPages || totalPages === 0;
            
            // é¡µç æŒ‰é’®
            const pageNumbers = document.getElementById('pageNumbers');
            const maxButtons = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
            let endPage = Math.min(totalPages, startPage + maxButtons - 1);
            
            if (endPage - startPage < maxButtons - 1) {
                startPage = Math.max(1, endPage - maxButtons + 1);
            }
            
            pageNumbers.innerHTML = '';
            for (let i = startPage; i <= endPage; i++) {
                const btn = document.createElement('button');
                btn.className = 'page-btn' + (i === currentPage ? ' active' : '');
                btn.textContent = i;
                btn.onclick = () => goToPage(i);
                pageNumbers.appendChild(btn);
            }
        }

        // =================================================================
        // åˆ†é¡µæ§åˆ¶
        // =================================================================
        function goToPage(page) {
            currentPage = page;
            renderTable();
            renderPagination();
        }

        function prevPage() {
            if (currentPage > 1) {
                goToPage(currentPage - 1);
            }
        }

        function nextPage() {
            if (currentPage < totalPages) {
                goToPage(currentPage + 1);
            }
        }

        function goToLastPage() {
            goToPage(totalPages);
        }

        // =================================================================
        // æ’åº
        // =================================================================
        function handleSort(field) {
            if (currentSort.field === field) {
                currentSort.order = currentSort.order === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.field = field;
                currentSort.order = 'asc';
            }
            
            // æ›´æ–°æ’åºå›¾æ ‡
            document.querySelectorAll('.sortable').forEach(th => {
                th.classList.remove('sorted-asc', 'sorted-desc');
            });
            const sortedTh = document.querySelector(`[data-sort="${field}"]`);
            sortedTh.classList.add('sorted-' + currentSort.order);
            
            applyFilters();
        }

        // =================================================================
        // é€‰æ‹©æ“ä½œ
        // =================================================================
        function handleSelectAll() {
            const checked = document.getElementById('selectAll').checked;
            const start = (currentPage - 1) * pageSize;
            const end = start + pageSize;
            const pageData = filteredData.slice(start, end);
            
            pageData.forEach(item => {
                if (checked) {
                    selectedIds.add(item.id);
                } else {
                    selectedIds.delete(item.id);
                }
            });
            
            updateBatchActions();
            renderTable();
        }

        function handleSelectRow(id) {
            if (selectedIds.has(id)) {
                selectedIds.delete(id);
            } else {
                selectedIds.add(id);
            }
            
            updateBatchActions();
            renderTable();
        }

        function updateBatchActions() {
            const batchActions = document.getElementById('batchActions');
            const count = selectedIds.size;
            
            if (count > 0) {
                batchActions.classList.add('active');
                document.getElementById('selectedCount').textContent = count;
            } else {
                batchActions.classList.remove('active');
            }
            
            // æ›´æ–°å…¨é€‰æ¡†çŠ¶æ€
            const start = (currentPage - 1) * pageSize;
            const end = start + pageSize;
            const pageData = filteredData.slice(start, end);
            const allSelected = pageData.length > 0 && pageData.every(item => selectedIds.has(item.id));
            document.getElementById('selectAll').checked = allSelected;
        }

        function clearSelection() {
            selectedIds.clear();
            updateBatchActions();
            renderTable();
        }

        // =================================================================
        // æ•°æ®æ“ä½œ
        // =================================================================
        function viewDetail(id) {
            const item = DataManager.getRecipientById(id);
            if (!item) return;
            
            document.getElementById('detailModalBody').innerHTML = `
                <div class="detail-grid">
                    <div class="detail-item">
                        <div class="detail-label">è®°å½•ID</div>
                        <div class="detail-value">${item.id}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">å§“å</div>
                        <div class="detail-value">${Utils.escapeHtml(item.name)}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">æ‰‹æœºå·</div>
                        <div class="detail-value">${item.phone}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">å¾®ä¿¡å·</div>
                        <div class="detail-value">${Utils.escapeHtml(item.wechat || '-')}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">å…³ç³»</div>
                        <div class="detail-value">${item.relation_text}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">åœ°å€</div>
                        <div class="detail-value">
                            ${item.address?.province || ''} 
                            ${item.address?.city || ''} 
                            ${item.address?.district || ''}<br>
                            ${Utils.escapeHtml(item.address?.detail || '')}
                            ${item.address?.zipcode ? '<br>é‚®ç¼–ï¼š' + item.address.zipcode : ''}
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">æœŸæœ›é…é€</div>
                        <div class="detail-value">${item.delivery_time || '-'}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">ç¥ç¦ç•™è¨€</div>
                        <div class="detail-value">${Utils.escapeHtml(item.blessing || '-')}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">æäº¤æ—¶é—´</div>
                        <div class="detail-value">${item.submit_time_formatted}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">è®¾å¤‡ä¿¡æ¯</div>
                        <div class="detail-value">${item.device_info || '-'}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">çŠ¶æ€</div>
                        <div class="detail-value">
                            <span class="status-badge ${item.status}">${item.status_text}</span>
                        </div>
                    </div>
                </div>
            `;
            
            openModal('detailModal');
        }

        function toggleStatus(id) {
            if (DataManager.toggleStatus(id)) {
                Utils.toast('çŠ¶æ€å·²æ›´æ–°', 'success');
                loadDashboard();
            } else {
                Utils.toast('çŠ¶æ€æ›´æ–°å¤±è´¥', 'error');
            }
        }

        function deleteRecord(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿ')) {
                if (DataManager.deleteRecipient(id)) {
                    Utils.toast('åˆ é™¤æˆåŠŸ', 'success');
                    selectedIds.delete(id);
                    loadDashboard();
                } else {
                    Utils.toast('åˆ é™¤å¤±è´¥', 'error');
                }
            }
        }

        // =================================================================
        // æ‰¹é‡æ“ä½œ
        // =================================================================
        function batchUpdateStatus() {
            if (confirm(`ç¡®å®šè¦å°†é€‰ä¸­çš„ ${selectedIds.size} æ¡è®°å½•æ ‡è®°ä¸ºå·²å‘è´§å—ï¼Ÿ`)) {
                let success = 0;
                selectedIds.forEach(id => {
                    if (DataManager.updateStatus(id, 'shipped')) {
                        success++;
                    }
                });
                Utils.toast(`æˆåŠŸæ›´æ–° ${success} æ¡è®°å½•`, 'success');
                clearSelection();
                loadDashboard();
            }
        }

        function batchDelete() {
            if (confirm(`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${selectedIds.size} æ¡è®°å½•å—ï¼Ÿ`)) {
                const ids = Array.from(selectedIds);
                const result = DataManager.batchDelete(ids);
                Utils.toast(`æˆåŠŸåˆ é™¤ ${result.success} æ¡è®°å½•`, 'success');
                clearSelection();
                loadDashboard();
            }
        }

        // =================================================================
        // å¯¼å‡ºåŠŸèƒ½
        // =================================================================
        
        // æ˜¾ç¤ºé«˜çº§å¯¼å‡ºå¯¹è¯æ¡†
        function showExportDialog() {
            const panel = document.getElementById('exportPanel');
            panel.style.display = 'block';
            
            // åˆå§‹åŒ–åœ°åŒºé€‰æ‹©å™¨
            initExportRegionSelectors();
            
            // æ›´æ–°é¢„è§ˆè®¡æ•°
            updateExportPreview();
        }
        
        // éšè—å¯¼å‡ºå¯¹è¯æ¡†
        function hideExportDialog() {
            document.getElementById('exportPanel').style.display = 'none';
        }
        
        // åˆå§‹åŒ–å¯¼å‡ºåœ°åŒºé€‰æ‹©å™¨
        function initExportRegionSelectors() {
            // å¡«å……çœä»½é€‰é¡¹ï¼ˆä»æ•°æ®ä¸­æå–ï¼‰
            const provinces = [...new Set(allData.map(item => item.address?.province).filter(Boolean))];
            const provinceSelect = document.getElementById('exportProvince');
            provinceSelect.innerHTML = '<option value="">å…¨éƒ¨çœä»½</option>';
            provinces.forEach(province => {
                provinceSelect.innerHTML += `<option value="${province}">${province}</option>`;
            });
        }
        
        // æ›´æ–°åŸå¸‚é€‰æ‹©å™¨
        function updateExportCities() {
            const province = document.getElementById('exportProvince').value;
            const citySelect = document.getElementById('exportCity');
            const districtSelect = document.getElementById('exportDistrict');
            
            citySelect.innerHTML = '<option value="">å…¨éƒ¨åŸå¸‚</option>';
            districtSelect.innerHTML = '<option value="">å…¨éƒ¨åŒºå¿</option>';
            
            if (province) {
                const cities = [...new Set(
                    allData
                        .filter(item => item.address?.province === province)
                        .map(item => item.address?.city)
                        .filter(Boolean)
                )];
                cities.forEach(city => {
                    citySelect.innerHTML += `<option value="${city}">${city}</option>`;
                });
            }
            
            updateExportPreview();
        }
        
        // æ›´æ–°åŒºå¿é€‰æ‹©å™¨
        function updateExportDistricts() {
            const province = document.getElementById('exportProvince').value;
            const city = document.getElementById('exportCity').value;
            const districtSelect = document.getElementById('exportDistrict');
            
            districtSelect.innerHTML = '<option value="">å…¨éƒ¨åŒºå¿</option>';
            
            if (province && city) {
                const districts = [...new Set(
                    allData
                        .filter(item => 
                            item.address?.province === province && 
                            item.address?.city === city
                        )
                        .map(item => item.address?.district)
                        .filter(Boolean)
                )];
                districts.forEach(district => {
                    districtSelect.innerHTML += `<option value="${district}">${district}</option>`;
                });
            }
            
            updateExportPreview();
        }
        
        // æ›´æ–°å¯¼å‡ºé¢„è§ˆè®¡æ•°
        function updateExportPreview() {
            const filters = getExportFilters();
            const filtered = ExportManager.filterData(allData, filters);
            document.getElementById('exportPreviewCount').textContent = filtered.length;
        }
        
        // è·å–å¯¼å‡ºç­›é€‰æ¡ä»¶
        function getExportFilters() {
            const filters = {};
            
            // æ—¶é—´èŒƒå›´
            const dateStart = document.getElementById('exportDateStart')?.value;
            const dateEnd = document.getElementById('exportDateEnd')?.value;
            if (dateStart || dateEnd) {
                filters.dateRange = { start: dateStart, end: dateEnd };
            }
            
            // åœ°åŒº
            const province = document.getElementById('exportProvince')?.value;
            const city = document.getElementById('exportCity')?.value;
            const district = document.getElementById('exportDistrict')?.value;
            if (province || city || district) {
                filters.region = { province, city, district };
            }
            
            // çŠ¶æ€
            const status = document.getElementById('exportStatus')?.value;
            if (status && status !== 'all') {
                filters.status = status;
            }
            
            // å…³ç³»
            const relation = document.getElementById('exportRelation')?.value;
            if (relation && relation !== 'all') {
                filters.relation = relation;
            }
            
            return filters;
        }
        
        // é‡ç½®å¯¼å‡ºç­›é€‰
        function resetExportFilters() {
            document.getElementById('exportDateStart').value = '';
            document.getElementById('exportDateEnd').value = '';
            document.getElementById('exportProvince').value = '';
            document.getElementById('exportCity').value = '';
            document.getElementById('exportDistrict').value = '';
            document.getElementById('exportStatus').value = 'all';
            document.getElementById('exportRelation').value = 'all';
            updateExportPreview();
        }
        
        // å¿«é€Ÿå¯¼å‡º
        async function quickExport(format) {
            try {
                const filters = getExportFilters();
                const options = {
                    filename: CONFIG.EXPORT.EXCEL_FILENAME,
                    filters: filters
                };
                
                switch (format) {
                    case 'excel':
                        await ExportManager.exportExcel(allData, options);
                        break;
                    case 'csv':
                        await ExportManager.exportCSV(allData, options);
                        break;
                    case 'print':
                        ExportManager.printData(allData, options);
                        break;
                    case 'clipboard':
                        await ExportManager.copyToClipboard(allData, options);
                        break;
                }
                
                // å¯¼å‡ºæˆåŠŸåéšè—é¢æ¿
                if (format !== 'print') {
                    hideExportDialog();
                }
                
            } catch (error) {
                console.error('Quick export error:', error);
                Utils.toast('å¯¼å‡ºå¤±è´¥: ' + error.message, 'error');
            }
        }
        
        // æ˜¾ç¤ºå¯¼å‡ºå†å²
        function showExportHistory() {
            const history = ExportManager.getExportHistory();
            const container = document.getElementById('exportHistoryContainer');
            
            if (history.length === 0) {
                container.innerHTML = `
                    <div class="empty-history">
                        <div class="empty-history-icon">ğŸ“Š</div>
                        <div>æš‚æ— å¯¼å‡ºè®°å½•</div>
                    </div>
                `;
            } else {
                container.innerHTML = history.map(record => {
                    const icon = {
                        'excel': 'ğŸ“Š',
                        'csv': 'ğŸ“„',
                        'print': 'ğŸ–¨ï¸',
                        'clipboard': 'ğŸ“‹'
                    }[record.type] || 'ğŸ“¦';
                    
                    return `
                        <div class="history-item">
                            <div class="history-header">
                                <div class="history-type">
                                    <span>${icon}</span>
                                    <span>${record.format}</span>
                                </div>
                                <div class="history-time">
                                    ${Utils.formatDate(record.timestamp, 'MM-DD HH:mm')}
                                </div>
                            </div>
                            <div class="history-details">
                                <div>
                                    <div class="history-detail-label">æ–‡ä»¶å</div>
                                    <div class="history-detail-value">${record.filename}</div>
                                </div>
                                <div>
                                    <div class="history-detail-label">è®°å½•æ•°</div>
                                    <div class="history-detail-value">${record.recordCount} æ¡</div>
                                </div>
                                <div>
                                    <div class="history-detail-label">æ–‡ä»¶å¤§å°</div>
                                    <div class="history-detail-value">${record.fileSize}</div>
                                </div>
                                ${record.duration ? `
                                <div>
                                    <div class="history-detail-label">è€—æ—¶</div>
                                    <div class="history-detail-value">${(record.duration / 1000).toFixed(2)}s</div>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            openModal('exportHistoryModal');
        }
        
        // æ¸…ç©ºå¯¼å‡ºå†å²ç¡®è®¤
        function clearExportHistoryConfirm() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å¯¼å‡ºè®°å½•å—ï¼Ÿ')) {
                ExportManager.clearExportHistory();
                showExportHistory();
                Utils.toast('å¯¼å‡ºè®°å½•å·²æ¸…ç©º', 'success');
            }
        }
        
        // æ—§ç‰ˆå¯¼å‡ºå‡½æ•°ï¼ˆä¿ç•™å…¼å®¹æ€§ï¼‰
        async function exportData(type, format, data = null) {
            try {
                const exportData = data || (type === 'selected' 
                    ? allData.filter(item => selectedIds.has(item.id))
                    : allData);
                
                if (exportData.length === 0) {
                    Utils.toast('æ²¡æœ‰å¯å¯¼å‡ºçš„æ•°æ®', 'error');
                    return;
                }
                
                if (format === 'excel') {
                    await ExportManager.exportExcel(exportData, { filename: CONFIG.EXPORT.EXCEL_FILENAME });
                } else if (format === 'csv') {
                    await ExportManager.exportCSV(exportData, { filename: CONFIG.EXPORT.EXCEL_FILENAME });
                } else if (format === 'json') {
                    const jsonData = {
                        exportedAt: new Date().toISOString(),
                        exportedBy: CONFIG.COUPLE.FULL_NAME,
                        version: '1.0',
                        total: exportData.length,
                        recipients: exportData
                    };
                    ExportUtils.exportJSON(jsonData, `${CONFIG.EXPORT.JSON_FILENAME}_${ExportUtils.formatDateTime(new Date(), 'YYYYMMDD_HHmmss')}.json`);
                }
            } catch (error) {
                console.error('Export error:', error);
                Utils.toast('å¯¼å‡ºå¤±è´¥: ' + error.message, 'error');
            }
        }
        
        // æ‰¹é‡å¯¼å‡º
        async function batchExport() {
            const selectedData = allData.filter(item => selectedIds.has(item.id));
            await exportData('selected', 'excel', selectedData);
        }

        // =================================================================
        // ç³»ç»Ÿç®¡ç†
        // =================================================================
        function openSettingsModal() {
            // æ›´æ–°ç³»ç»Ÿä¿¡æ¯
            const storageUsage = DataManager.getStorageUsage();
            const storageSize = DataManager.getStorageSize();
            document.getElementById('storageInfo').textContent = 
                `${(storageSize / 1024).toFixed(2)} KB (${storageUsage}%)`;
            
            const sessionRemaining = AdminAuth.getSessionRemainingTimeFormatted();
            document.getElementById('sessionInfo').textContent = sessionRemaining;
            
            openModal('settingsModal');
        }

        function changePassword() {
            const oldPassword = document.getElementById('oldPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            
            if (!oldPassword || !newPassword) {
                Utils.toast('è¯·å¡«å†™å®Œæ•´çš„å¯†ç ä¿¡æ¯', 'error');
                return;
            }
            
            const result = AdminAuth.changePassword(oldPassword, newPassword);
            if (result.success) {
                Utils.toast('å¯†ç ä¿®æ”¹æˆåŠŸ', 'success');
                document.getElementById('oldPassword').value = '';
                document.getElementById('newPassword').value = '';
                closeModal('settingsModal');
            } else {
                Utils.toast(result.message, 'error');
            }
        }

        function backupData() {
            if (DataManager.createBackup()) {
                Utils.toast('æ•°æ®å¤‡ä»½æˆåŠŸ', 'success');
            } else {
                Utils.toast('æ•°æ®å¤‡ä»½å¤±è´¥', 'error');
            }
        }

        function restoreData() {
            if (confirm('ç¡®å®šè¦ä»å¤‡ä»½æ¢å¤æ•°æ®å—ï¼Ÿå½“å‰æ•°æ®å°†è¢«è¦†ç›–ï¼')) {
                if (DataManager.restoreFromBackup()) {
                    Utils.toast('æ•°æ®æ¢å¤æˆåŠŸ', 'success');
                    loadDashboard();
                } else {
                    Utils.toast('æ•°æ®æ¢å¤å¤±è´¥æˆ–æ— å¤‡ä»½æ•°æ®', 'error');
                }
            }
        }

        function clearAllData() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼\n\nå»ºè®®å…ˆå¤‡ä»½æ•°æ®ã€‚')) {
                if (confirm('å†æ¬¡ç¡®è®¤ï¼šçœŸçš„è¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿ')) {
                    DataManager.clearAll(true);
                    Utils.toast('æ•°æ®å·²æ¸…ç©ºï¼ˆå·²è‡ªåŠ¨å¤‡ä»½ï¼‰', 'success');
                    loadDashboard();
                    closeModal('settingsModal');
                }
            }
        }

        // =================================================================
        // è¾…åŠ©å‡½æ•°
        // =================================================================
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function loadProvinceFilter() {
            const provinces = [...new Set(allData.map(item => item.address?.province).filter(Boolean))];
            const select = document.getElementById('filterProvince');
            select.innerHTML = '<option value="">å…¨éƒ¨åœ°åŒº</option>' +
                provinces.map(p => `<option value="${p}">${p}</option>`).join('');
        }

        // =================================================================
        // äº‹ä»¶ç›‘å¬
        // =================================================================
        document.getElementById('searchInput').addEventListener('input', Utils.debounce(applyFilters, 300));
        document.getElementById('filterStatus').addEventListener('change', applyFilters);
        document.getElementById('filterProvince').addEventListener('change', applyFilters);

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // ESC é”®å…³é—­æ¨¡æ€æ¡†
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.remove('active');
                });
            }
        });
    </script>
</body>
</html>